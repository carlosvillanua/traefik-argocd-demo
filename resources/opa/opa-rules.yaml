kind: ConfigMap
metadata:
  name: example-policy
  namespace: traefik
  labels:
    openpolicyagent.org/policy: rego
data:
  example.rego: |
    package example

    import future.keywords.in
    import future.keywords.if

    default allow := false

    allow if {
        input.method == "GET"
        input.path[0] == "public"
    }

    allow if {
        input.method == "GET"
        input.path[0] == "secure"
        input.path[1] in {"123", "456"}
    }